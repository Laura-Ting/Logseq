- DONE 查top k进度条变化慢的原因
- DONE 查卡高度pcd不变的原因
- DONE hovsg query pcd能不能不每次重新建点云，而是只建一次，然后取对应索引重新上色
- 把habitat分batch然后merge的操作拿过来，并写文档
- 页面布局重构
- 添加场景切换
- 接口整理
-
- Method：Ours，HOVSG，Clio
- 切方法的Button(首次切方法做每个的耗时工作，比如文件加载和计算)
- 3D Visualization Settings
	- Scene Info
		- 显示scene id(总的，重新划分，比如25个)，scene name，floor id
		- Slider可以滑动选择要scene id
		- 按钮switch scene，触发场景切换
	- Mapper Configuration
		- Origin Mesh
		- H Lower Bound
		- H Upper Bound
	- Mesh Configuration
		- Construct Mesh用于更新
		- Visualize Mesh
		- Coloring Type
		- Category Query（这个目前应该只有GiftedNav）
		- Meshing Voxel Size
		- Remove Artifacts
	- GT
		- GT Mesh
		- GT Semantic PCD
		- GT RGB PCD
		- Current GT BBox
		- All GT BBoxes
	- Ours
		- Construct Semantic Query Mesh
		- switch checkbox
	- HOVSG
		- Construct Semantic Query PCD
		- switch checkbox
	- Clio
	- 横栏
		- GT Instance Slider
		- gt info txt: gt category name, gt id, current gt bbox
		- Semantic Query Threshold: for both pcd and mesh
		- Top K Threshold: for both pcd and mesh
-
- floor id和scene id通过参数方式指定
- gt要存id，而不是category
- gt每帧点云融合的时候，用体素找点，如果当前体素内部有点，就不把其他落在这个体素内的点加上去。或者用0.02的整数倍去找x，y，z体素坐标
-
- DataLoader
	- hovsg
		- gt
			- gt semantic pcd：scene_pcd。所有楼层的完整点云并根据楼层高度裁剪。仅用于可视化
			- gt rgb pcd：scene_rgb_pcd。所有楼层的完整点云并根据楼层高度裁剪。仅用于可视化
			- gt points label pcd：根据pose截取。用于给pred points分配gt label
		- pred
			- objects_data字典，key为object_id, value为obj_pcd与obj_embedding。三层楼所有的obj node，目前是根据高度判断留下来的node。现在需要卡pose sequence只重建对应楼层的scene graph
	- ours
		- gt
			- gt mesh：scene_mesh。所有楼层的完整mesh并根据楼层裁剪。可视化+remove artifacts
		- pred
			- checkpoints
- Mapper
	- mesh
		- get_mesh()：获取用于展示的mesh。 __vertices_faces_to_mesh中进行颜色转换。 __remove_artifacts。
	- pcd
		- ##### Defination
		  collapsed:: true
			- the number of gt points: N
			- the number of pred points: M
			- the length of total gt category list: T
			- feature dimension: D
		- ##### get_pcd()
		  collapsed:: true
			- Function: Generates a point cloud with colors based on the similarity between text queries and object embeddings, and applies a transformation.
			  Input:
				- hovsg_query_semantic_zip (Tuple): Contains tuple elements (yolofn, text_value, obj_info, threshold_percentage).
				- dist_thresh (float): Distance threshold.
				- clip_model (torch.nn.Module): Model to compute text features.
				- hovsg_full_pcd (o3d.geometry.PointCloud): Full point cloud.
				- current_floor_lower_bound (float): Lower height bound for the current floor.
				- current_floor_upper_bound (float): Upper height bound for the current floor.
			- Output:
				- scene (o3d.geometry.PointCloud): Transformed point cloud with colors reflecting similarity scores.
			- TODO
		- ##### calculate_topk_pcd()
		  collapsed:: true
			- **Function:** Calculates the top-k point cloud based on similarity scores between object embeddings and text features, transforming and coloring points accordingly.
			  **Input:**
				- thresh (int): Threshold for filtering, keep the points with topk indices.
				- clip_model (torch.nn.Module): Model to compute text features.
				- total_gt_categories_text (List[str], length: T): List of ground truth category texts.
				- obj_info (Dict): Dictionary containing object embeddings and points.
				- gt_coords (np.array, shape: [N, 3]): Ground truth coordinates.
				- gt_semantics (np.array, shape: [N]): Ground truth semantic labels.
			- **Intermediate Saved Data:**
				- all_query_text_feats-> all_query_text_feats.npy:  (np.array, shape: [T, D]): the clip-features of total gt categories
				- points_in_node->points_in_node.ply:  (np.array, shape: [M, 3]): coord of each pred point
				- pred_k_index->pred_k_index.npy:  (np.array, shape: [M]): index of where the gt label appears in sorted label list for each pred point
			- **Output:**
				- points_top_k (o3d.geometry.PointCloud): Transformed and colored point cloud with top-k points.
			- **TODO:**
				- 传入参数删掉没有用的hovsg_current_pcd，hovsg_gt_points_semantic_pcd，hovsg_gt_points_category_map_path
				- gt_categories_text 名字改成带total
				- thresh 应该是个整数，应该改成int类型
				- 看是否可以不用遍历
		- ##### get_thresh_precentage_pcd
		  collapsed:: true
			- **Function:** Applies a percentage threshold(0-100) to a point cloud, modifying colors.
			  **Input:**
				- hovsg_query_semantic_pcd (o3d.geometry.PointCloud): Input point cloud with semantic information.
				- thresh_precentage (int): Percentage to determine the color threshold.
			- **Output:**
				- hovsg_thresh_query_semantic_pcd (o3d.geometry.PointCloud): Point cloud with colors modified according to the threshold.
			- **TODO:**
				- percentage threshold 是int
	- common function：
		- ##### __assign_labels_to_pred()
		  collapsed:: true
			- **Function:** Assigns gt labels to predicted points using a KD-Tree for efficient nearest neighbor search.
			  **Input:**
				- gt_coords (numpy array, shape: [N, 3]): Ground truth coordinates.
				- pred_points (numpy array, shape: [M, 3]): Predicted points.
				- gt_semantics (numpy array, shape: [N]): Ground truth semantic labels.
			- **Output:**
				- gt_labels (numpy array, shape: [M]): Assigned ground truth labels for each predicted point.
			- **TODO:**
				- 命名待修正，hovsg_去掉这个前缀
				- 命名返回改为pred_points_gt_labels
				- 命名改为__assign_labels_to_pred
-
-